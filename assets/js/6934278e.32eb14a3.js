"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[5642],{35318:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>h});var n=r(27378);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=c(r),h=i,f=d["".concat(s,".").concat(h)]||d[h]||u[h]||a;return r?n.createElement(f,l(l({ref:t},p),{},{components:r})):n.createElement(f,l({ref:t},p))}));function h(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,l=new Array(a);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var c=2;c<a;c++)l[c]=r[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},42352:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var n=r(25773),i=(r(27378),r(35318));const a={title:"Apache APISIX Vulnerability for Rewriting X-REAL-IP Header (CVE-2022-24112)",keywords:["Vulnerability","Header","IP restrictions"],description:"In versions prior to Apache APISIX 2.12.1, there is a risk of rewriting X-REAL-IP header after enabling the Apache APISIX `batch- requests` plugin.",tags:["Security"],image:"https://static.apiseven.com/2022/blog/0818/cve/CVE-2022-24112.png"},l=void 0,o={permalink:"/blog/2022/02/11/cve-2022-24112",source:"@site/blog/2022/02/11/cve-2022-24112.md",title:"Apache APISIX Vulnerability for Rewriting X-REAL-IP Header (CVE-2022-24112)",description:"In versions prior to Apache APISIX 2.12.1, there is a risk of rewriting X-REAL-IP header after enabling the Apache APISIX `batch- requests` plugin.",date:"2022-02-11T00:00:00.000Z",formattedDate:"February 11, 2022",tags:[{label:"Security",permalink:"/blog/tags/security"}],readingTime:1.23,truncated:!0,authors:[],prevItem:{title:"How to develop plugin in API Gateway",permalink:"/blog/2022/02/16/file-logger-api-gateway"},nextItem:{title:"Integrating Splunk HTTP Event Collector with API Gateway",permalink:"/blog/2022/02/10/splunk-apisix-integration"}},s={authorsImageUrls:[]},c=[{value:"Problem Description",id:"problem-description",children:[],level:2},{value:"Affected Versions",id:"affected-versions",children:[],level:2},{value:"Solution",id:"solution",children:[],level:2},{value:"Vulnerability details",id:"vulnerability-details",children:[],level:2},{value:"Contributor Profile",id:"contributor-profile",children:[],level:2}],p={toc:c};function u(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"In versions prior to Apache APISIX 2.12.1, there is a risk of rewriting X-REAL-IP header after enabling the Apache APISIX ",(0,i.kt)("inlineCode",{parentName:"p"},"batch-requests")," plug-in. Now the processing information will be announced.")),(0,i.kt)("h2",{id:"problem-description"},"Problem Description"),(0,i.kt)("p",null,"In versions of Apache APISIX prior to 2.12.1 (excluding 2.12.1 and 2.10.4), there is a risk of rewriting the X-REAL-IP header when the Apache APISIX batch-requests plugin is enabled."),(0,i.kt)("p",null,"This risk leads to two problems:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"An attacker bypasses the IP restrictions on the Apache APISIX data plane via the batch-requests plugin. For example, bypassing IP black and white list restrictions."),(0,i.kt)("li",{parentName:"ul"},"If the user uses the default Apache APISIX configuration (Admin API enabled, with the default Admin Key and no additional admin port assigned), an attacker can invoke the Admin API via the batch-requests plug-in.")),(0,i.kt)("h2",{id:"affected-versions"},"Affected Versions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"All versions of Apache APISIX between 1.3 ~ 2.12.1 (excluding 2.12.1)"),(0,i.kt)("li",{parentName:"ul"},"All LTS versions of Apache APISIX between 2.10.0 ~ 2.10.4 (excluding 2.10.4)")),(0,i.kt)("h2",{id:"solution"},"Solution"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"This issue has been resolved in versions 2.12.1 and 2.10.4, please update to the relevant version as soon as possible."),(0,i.kt)("li",{parentName:"ul"},"In affected versions of Apache APISIX, you can avoid this risk by explicitly commenting out batch-requests in the conf/config.yaml and conf/config-default.yaml files and restarting Apache APISIX.")),(0,i.kt)("h2",{id:"vulnerability-details"},"Vulnerability details"),(0,i.kt)("p",null,"Severity\uff1aHigh"),(0,i.kt)("p",null,"Vulnerability public date: February 11, 2022"),(0,i.kt)("p",null,"CVE details: ",(0,i.kt)("a",{parentName:"p",href:"https://nvd.nist.gov/vuln/detail/CVE-2022-24112"},"https://nvd.nist.gov/vuln/detail/CVE-2022-24112")),(0,i.kt)("h2",{id:"contributor-profile"},"Contributor Profile"),(0,i.kt)("p",null,"This vulnerability was reported to the Apache Software Foundation by Sauercloud. Thank you for your contributions to the Apache APISIX community."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://static.apiseven.com/202108/1644632196291-6b9bca14-7893-47c7-9f93-99c28ff54044.png",alt:"Sauercloud"})))}u.isMDXComponent=!0}}]);